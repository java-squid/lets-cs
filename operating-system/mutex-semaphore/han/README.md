# Mutex
- Mutual (mut) + Exclusion (ex) 의 합성어
- 상호 배제를 의미
- 여러 스레드를 실행하는 환경, 자원에 대한 접근을 강제하기 위한 동기화 방식

> Mutual Exclusion

- 하나의 프로세스가 공유 자원을 사용할 때, 다른 프로세스가 해당 자원에 접근하지 못하도록 하는 것.
  - 즉 공유 자원에 점유할 수 있는 프로세스, 스레드의 수는 한 개라는 의미..?
- 어떻게 접근하지 못하도록 할까?
- 어떻게 다른 프로세스가 공유 자원이 사용할 수 있는지, 없는지 알 수 있을까?

> 작동 방식

1. Lock
    - 공유 자원에는 `Boolean Lock` 변수가 있음
        - Lock = true을 한 스레드만 Lock을 풀 수 있음.
    - 그리고 공유자원을 사용하려하고는 스레드들을 위한 **대기큐**가 있음.
    - 현재 공유자원을 점유하고 있는 스레드가 있을 경우, 이 자원에 접근하는 스레드들을 `blocking` 시키고, 대기큐에 적재하여 `sleeping` 상태로 변경해둠.
    - 공유 자원의 Lock 변수가 false라면, 비어져 있다면, 대기큐에서 하나 깨워서 점유하게 만듬.

2. SpinLock
- Busy-wating 방식
- 공유자원에 접근하는 스레드는, 계속 공유 자원에게 자리가 있는지 계속 물어보는 방식 (대기큐가 없다)
- 그럼 비효율적 
    - 왜?
    - 해당 공유자원을 점유하고 있는 스레드 뿐만 아니라, 물어보는 다른 스레드의 요청까지 처리해줘야 하므로..
- 그럼 어떤 상황에 위 방식을 사용할까?
  - 대기큐를 사용하는 방식보다, 공유자원에게 물어보는 시간이 짦다면.. 굳이 대기큐를 사용하지 않아도 될듯. (컨텍스트 스위칭 시간이 짦으면..)
  - 다른 스레드의 질의를 처리할 여유가 있을 때 (멀티 프로세스 일 때)


# Semaphore
- 다수의 프로세스, 스레드가 여러 개의 공유자원에 대한 접근을 제한하는 방법
- Mutex랑은 다르게, 여러 프로세스, 스레드가 공유자원에 접근할 수 있다는 차이점이 있음 (뮤텍스는 하나의 스레드가 공유자원에 접근할 때의 접근을 제어하는 방식을 이야기 하는듯)
- P(wait), V(signal)
- 변수는 정수형 (뮤텍스는 boolean... 변수)

> 작동 방식

1. Sleep - wait
- 대기큐 사용
- 공유 자원에 자리가 생기면, 대기큐에서 잠자고 있는 스레드를 꺠우는 방식

2. SpinLock
- Busy - wating 방식

# 정리

1. Mutex를 이용하는 환경은, 공유 자원에 하나의 소비자 (프로세스 혹은 스레드) 가 점유가 가능할 때 사용함.
2. 엄밀하게 말하면 Mutex는 locking mechanism임. 즉 공유 자원을 잠그고, 열는 과정에 대한 것인듯.
  - 즉 자원에 동기적인 접근이 가능토록 하는 방법
  - 뮤텍스를 통해 공유자원을 잠근 소유자만, 뮤텍스를 통해 공유자원을 릴리즈 할 수 있다 (뮤텍스에 대한 소유권이 존재한다.)

3. Semaphore를 이용하는 환경은, 공유 자원에 여러 소비자 (여러 프로세스, 혹은 여러 스레드) 가 점유 가능할 때 사용하는 방법 인듯.
4. Semaphore는 signaling mechanism 임 (소비자가 다른 소비자에게 알려주는 방식)
  - 어떤 자원을 점유하고 있는 소비자 중 한명이, 자신이 다 끝났으면 다른 대기하는 소비자에게 알려주는 방식인듯

# 참고
- https://www.youtube.com/watch?v=oazGbhBCOfU
- https://en.wikipedia.org/wiki/Semaphore_(programming)
- https://www.geeksforgeeks.org/mutex-vs-semaphore/